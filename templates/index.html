<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>リンゴ葉色CC評価ツール</title>
    <style>
        table {
            border-collapse: collapse;
            width: 80%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px 12px;
            text-align: center;
        }
        th {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>リンゴ葉色CC評価ツール</h1>
    <form method="post">
        <label for="L">L値:</label>
        <input type="number" step="0.01" name="L" required><br>
        <label for="a">a値:</label>
        <input type="number" step="0.01" name="a" required><br>
        <label for="b">b値:</label>
        <input type="number" step="0.01" name="b" required><br>
        <input type="submit" value="評価">
    </form>

    {% if input_lab %}
        <h2>結果</h2>
        <p>入力値: L={{ input_lab[0] }}, a={{ input_lab[1] }}, b={{ input_lab[2] }}</p>

        <h3>CC値とのΔE一覧</h3>
        <table>
            <tr>
                <th colspan="2">直接入力CC</th>
                <th colspan="2">Excel由来CC</th>
            </tr>
            <tr>
                <th>CC値</th><th>ΔE</th>
                <th>CC値</th><th>ΔE</th>
            </tr>
            {% for i in range(max(deltas_direct|length, deltas_excel|length)) %}
            <tr>
                <td>{{ deltas_direct[i].cc if i < deltas_direct|length else '' }}</td>
                <td>{{ deltas_direct[i].delta if i < deltas_direct|length else '' }}</td>
                <td>{{ deltas_excel[i].cc if i < deltas_excel|length else '' }}</td>
                <td>{{ deltas_excel[i].delta if i < deltas_excel|length else '' }}</td>
            </tr>
            {% endfor %}
        </table>

        <p><strong>最も近い直接入力CC値: {{ closest_direct.cc }}（ΔE = {{ closest_direct.delta }}）</strong></p>
        <p><strong>最も近いExcel由来CC値: {{ closest_excel.cc }}（ΔE = {{ closest_excel.delta }}）</strong></p>
    {% endif %}
</body>
</html>
